<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<title></title>
        <link rel="stylesheet" href="/static/font-awesome/css/font-awesome.min.css">
		<link rel="stylesheet" type="text/css" href="/static/datacockpit/css/swiper.min.css" />
		<link rel="stylesheet" type="text/css" href="/static/datacockpit/css/reset.css" />
		<link rel="stylesheet" type="text/css" href="/static/datacockpit/css/css.css" />
        <link rel="stylesheet" href="/static/layui/css/layui.css">
	</head>

	<body>
		<div class="main_content">
			<div class="main_left">
				<div class="cc on c1"><img src="/static/datacockpit/images/page_03.png" class="ic1"/><img src="/static/datacockpit/images/tp_06.png" class="ics1"/></div>
				<div class="cc c2"><img src="/static/datacockpit/images/tp_17.png" class="ic1"/><img src="/static/datacockpit/images/page_11.png" class="ics1"/></div>
				<div class="cc c3"><img src="/static/datacockpit/images/page_32.png" class="ic1"/><img src="/static/datacockpit/images/tp_08.png" class="ics1"/></div>
				<div class="cc c4"><img src="/static/datacockpit/images/page_58.png" class="ic1"/><img src="/static/datacockpit/images/tp_10.png" class="ics1"/></div>
				<div class="cc c5"><img src="/static/datacockpit/images/page_65.png" class="ic1"/><img src="/static/datacockpit/images/tp_12.png" class="ics1"/></div>
				<div class="cc c6"><img src="/static/datacockpit/images/page_74.png" class="ic1"/><img src="/static/datacockpit/images/tp_14.png" class="ics1"/></div>
				<div id = 'caption' class="ics">
					 <span style="font-size: 30px; color: white;"><p>环境监测</p></span> <br/>
                     <div>
                         <img src="/static/datacockpit/images/pmzc.png" height="20" width="20"><span style="font-size: 15px; color: white;"><p>PM 2.5 正常</p></span> <br/>
                     </div>
                    <div>
                        <img src="/static/datacockpit/images/pmhs.png" height="20" width="20"><span style="font-size: 15px; color: white;"><p>PM 2.5 黄色预警</p></span> <br/>
                    </div>
                    <div>
                        <img src="/static/datacockpit/images/pmcs.png" height="20" width="20"><span style="font-size: 15px; color: white;"><p>PM 2.5 橙色预警</p></span> <br/>
                    </div>
                    <div>
                        <img src="/static/datacockpit/images/pmred.png" height="20" width="20"><span style="font-size: 15px; color: white;"><p>PM 2.5 红色预警</p></span> <br/>
                    </div>
				</div>
			</div>
			<div class="main_mid">
                <div id="china-map" style="width: 100%;height: 100%;"></div>
			</div>
            <div class="main_right">
                <div class="layui-carousel" id="pl_env" lay-filter="change_env" style="background-color: rgba(28,27,41, 0.3);">
                    <div carousel-item>
                        <div id="ENV_TOTAL" style="width: 100%; height: 100%; background-color: rgba(28,27,41, 0.3); padding: 20px" >
                            <div class="right_tit">
                                <div class="fl">
                                    <p>{{ envdev_count }}</p>
                                </div>
                                <div class="fr">
                                    <p>ENVDETECTION TOTAL</p>
                                    <span>环境传感器总数</span>
                                </div>
                            </div>
                            <div class="num">
                                <div class="t">
                                    <p>{{ enable_count.count }}</p>
                                    {% for rows in enable_count %}
                                        <img src="/static/datacockpit/images/page_14.png" />
                                    {% endfor %}
                                </div>
                                <div class="b">
                                    <p>在线总数</p>
                                    <span>ONLINE<br />NUMBER</span>
                                </div>
                            </div>
                            <div class="num">
                                <div class="t">
                                    <p>{{ disable_count.count }}</p>
                                    {% for rows in disable_count %}
                                        <img src="/static/datacockpit/images/page_14.png" />
                                    {% endfor %}
                                </div>
                                <div class="b">
                                    <p>离线总数</p>
                                    <span>OFFLINE<br />NUMBER</span>
                                </div>
                            </div>
                            <div class="zt">
                                <p>运行状态</p>
                                <span>RUNNING<br />STATE</span>
                            </div>
                            <div id="prjName">
                                <span style="color: wheat; font-size: 15px"><p><i class="fa fa-street-view" aria-hidden="true"></i> 实时数据</p></span>
                            </div>
                            <div class="layui-row layui-col-space10" style="width: 100%; padding: 10px" >
                                <div class="layui-col-md4">
                                    <p align="center"><img align="left" src="/static/datacockpit/images/PM25.png" title="PM2.5指数" style="height: 48px; width: 48px" /><div id="city_pm25"><span style="font-size: 38px; color: #A7FFFD">&nbsp;--</span></div></p>
                                </div>

                                <div class="layui-col-md4">
                                    <p align="center"><img align="left" src="/static/datacockpit/images/PM10.png" title="PM10指数" style="height: 48px; width: 48px" /><div id="city_pm10"><span style="font-size: 38px; color: #A7FFFD">&nbsp;--</span></div></p>
                                </div>

                                <div class="layui-col-md4">
                                    <p align="center"><img align="left" src="/static/datacockpit/images/noise.png" title="噪声" style="height: 48px; width: 48px" /><div id="city_noise"><span style="font-size: 38px; color: #A7FFFD">&nbsp;--</span></div></p>
                                </div>
                            </div>

                            <div class="layui-row layui-col-space10" style="width: 100%; padding: 10px" >
                                <div class="layui-col-md4">
                                    <p align="center"><img align="left" src="/static/datacockpit/images/temp.png" title="温度" style="height: 48px; width: 48px" /><div id="city_temp"><span style="font-size: 38px; color: #A7FFFD">&nbsp;--</span></div></p>
                                </div>

                                <div class="layui-col-md4">
                                    <p align="center"><img align="left" src="/static/datacockpit/images/shidu.png" title="湿度" style="height: 48px; width: 48px" /><div id="city_shidu"><span style="font-size: 38px; color: #A7FFFD">&nbsp;--</span></div></p>
                                </div>

                                <div class="layui-col-md4">
                                    <p align="center"><img align="left" src="/static/datacockpit/images/fengsu.png" title="风速" style="height: 48px; width: 48px" /><div id="city_fengsu"><span style="font-size: 38px; color: #A7FFFD">&nbsp;--</span></div></p>
                                </div>
                            </div>

                            <span style="color: wheat; font-size: 15px"><p><i class="fa fa-area-chart" aria-hidden="true"></i> 历史数据</p></span>

                            <div class="layui-row layui-col-space10" style="width: 100%; padding-top: 0px;" >
                                <div class="layui-col-md12">
                                    <div id="prj_hisdata" style="width: 100%; height: 35vh"></div>
                                    <div style="height:1px; margin-top:-1px;clear: both;overflow:hidden;"></div>
                                </div>
                            </div>
                        </div>

                        <div id="ENV_DETAIL" style="width: 100%; height: 100%; background-color: rgba(28,27,41, 0.3); padding: 20px">
                            <div class="right_tit">
                                <div class="fl">
                                    <span style="font-size: 25px; color: white">9 区/县</span>
                                </div>
                                <div class="fr">
                                    <p>ENVDETECTION AREA ANALYSE</p>
                                    <span>环境数据分析</span>
                                </div>
                            </div>

                            <div class="zt">
                                <p>区县数据分析</p>
                                <span>AREA<br />ANALYSE</span>
                            </div>

                            <div class="layui-row layui-col-space10" style="width: 100%; padding: 5px" >
                                <div class="layui-col-md12">
                                    <div id="area_analyse" style="width:28.04vw; height: 35vh"></div>
                                </div>
                            </div>

                            <div class="zt">
                                <p>项目详细数据</p>
                                <span>DETAIL<br />DATA</span>
                            </div>

                            <div class="layui-row layui-col-space10" style="width: 27.04vw; padding: 5px" >
                                <table class="layui-table" id="datasource" lay-filter="toolbar"></table>
                            </div>

                        </div>
                    </div>

                </div>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="/static/datacockpit/js/jquery-2.1.4.js"></script>
	<script type="text/javascript" src="/static/datacockpit/js/swiper.min.js"></script>
	<script type="text/javascript" src="/static/datacockpit/js/echarts.min.js"></script>
    <script type="text/javascript" src="/static/datacockpit/js/dark.js"></script>
    <script type="text/javascript" src="/static/layui/layui.js"></script>

	<script>
        layui.config({
            base: '/static/layui/ext/',   // 模块所在目录
        }).extend({
            soulTable: 'soulTable'  // 模块别名
        });

        layui.use(['element', 'layer','laydate','carousel', 'form', 'table', 'soulTable'], function() {
            var
                $ = layui.jquery
                , element = layui.element //Tab的切换功能，切换事件监听等，需要依赖element模块
                , layer = layui.layer
                , laydate = layui.laydate
                , carousel = layui.carousel
                , form = layui.form
                , table = layui.table
                , soulTable = layui.soulTable;

            var ins = carousel.render({
                elem: '#pl_env'
                ,width: '100%' //设置容器宽度
                ,height: '100vh'
                ,arrow: 'none'
                ,indicator: 'inside'
                ,interval: '10000'
                ,autoplay: true
            });

            table.render({
                limit: 20,
                height: 'full',
                elem: '#datasource',
                url: "{% url 'devicecockpit:get_datasource' %}",
                cols: [[
                    {field:'name', width: '15%', title: '区县名称', sort: true},
                    {field:'FPrjname', width: '24%', title: '接入项目名称', sort: true},
                    {field:'pm25', width: '20%', title: 'PM2.5平均值', sort: true},
                    {field:'pm10', width: '20%', title: 'PM10平均值', sort: true},
                    {field:'noise', width: '20%', title: '噪声平均值', sort: true},
                ]],
                id: 'runreload'
            });

            $('.main_content .main_left .cc').click(function(){
                var n = $(this).index();

                $(this).addClass('on').siblings().removeClass('on');
            });

            //地图模块echarts
            var myChart = echarts.init(document.getElementById('china-map'));
            var jx = {"type": "FeatureCollection", "features": [{"type":"Feature","properties":{"name":"安义县"},"geometry":{"type":"MultiPolygon","coordinates":[[[[115.657345,28.8038430000001],[115.669537382813,28.8004201484375],[115.660767851563,28.7916506171875],[115.657345,28.8038430000001]]],[[[115.673922148438,28.9560353828125],[115.677345,28.943843],[115.665152617188,28.9472658515625],[115.673922148438,28.9560353828125]]],[[[115.657345,28.8038430000001],[115.651158476563,28.8000295234375],[115.6357825,28.7549123359376],[115.643980742188,28.7285915351563],[115.627345,28.6938430000001],[115.610738554688,28.6641823554688],[115.590894804688,28.6488649726563],[115.56170046875,28.60948753125],[115.557345,28.583843],[115.525426054688,28.5878688789063],[115.517345,28.603843],[115.52170046875,28.60948753125],[115.53298953125,28.61819846875],[115.550860625,28.7234108710938],[115.528370390625,28.7407692695313],[115.462428007813,28.7280910468751],[115.4443371875,28.7307643867188],[115.43298953125,28.7627614570313],[115.45298953125,28.7781984687501],[115.478140898438,28.8107814765625],[115.487345,28.8438430000001],[115.505250273438,28.83632346875],[115.524503203125,28.8642116523438],[115.518253203125,28.8920900703125],[115.50142703125,28.9179274726563],[115.49326296875,28.9397585273438],[115.459185820313,28.9806203437501],[115.467345,29.013843],[115.536495390625,29.0095583320313],[115.566314726563,28.9663698554688],[115.584342070313,28.9704128242187],[115.64326296875,28.9497585273438],[115.680816679688,28.9206545234375],[115.731920195313,28.9321096015625],[115.75142703125,28.8979274726563],[115.757345,28.893843],[115.753170195313,28.8880178046875],[115.740367460938,28.8788430000001],[115.754000273438,28.8690724921876],[115.740968046875,28.8196681953126],[115.721519804688,28.8280178046876],[115.707345,28.8477956367188],[115.693170195313,28.8280178046876],[115.661519804688,28.8096681953126],[115.657345,28.8038430000001]]]]}},{"type":"Feature","properties":{"name":"东湖区"},"geometry":{"type":"MultiPolygon","coordinates":[[[[115.94310671875,28.7110964179688],[115.947345,28.673843],[115.880704375,28.6772023750001],[115.867345,28.6838430000001],[115.87638796875,28.696938703125],[115.923975859375,28.7279274726563],[115.94310671875,28.7110964179688]]]]}},{"type":"Feature","properties":{"name":"进贤县"},"geometry":{"type":"MultiPolygon","coordinates":[[[[116.334224882813,28.7497585273438],[116.362345,28.7486452460938],[116.37252078125,28.7490480781251],[116.383077421875,28.7376540351563],[116.4408996875,28.7103688789063],[116.442740507813,28.663843],[116.441773710938,28.6393752265626],[116.452535429688,28.6190334296875],[116.462154570313,28.5986525703125],[116.557345,28.4938430000001],[116.550206328125,28.4883303046876],[116.561119414063,28.4144753242188],[116.524771757813,28.3864186835938],[116.500670195313,28.3551930976563],[116.50611453125,28.3183303046875],[116.48170046875,28.2994875312501],[116.464937773438,28.2585305],[116.383433867188,28.2446852851563],[116.36298953125,28.21819846875],[116.357345,28.213843],[116.338897734375,28.2360524726563],[116.315816679688,28.2483815742188],[116.302769804688,28.2182912421875],[116.27634890625,28.2209841132813],[116.239639921875,28.2071901679688],[116.219058867188,28.1597389960938],[116.202808867188,28.1793044257813],[116.169644804688,28.1890383125],[116.139249296875,28.2256276679688],[116.107345,28.243843],[116.100704375,28.2572023750001],[116.097345,28.2738430000001],[116.091705351563,28.2986818671876],[116.09431765625,28.3197096992187],[116.078267851563,28.3177150703125],[116.052896757813,28.3493971992188],[116.020084257813,28.3756716132812],[116.024830351563,28.413843],[116.021676054688,28.4392018867188],[116.04423953125,28.4775807929688],[116.120831328125,28.455708234375],[116.1414075,28.4814040351563],[116.153746367188,28.5384352851563],[116.202896757813,28.5682888007813],[116.244644804688,28.6204225898438],[116.262579375,28.6181911445312],[116.291793242188,28.62722190625],[116.2613684375,28.6688674140625],[116.293018828125,28.7084377265625],[116.290499296875,28.7286672187501],[116.317345,28.743843],[116.334224882813,28.7497585273438]]]]}},{"type":"Feature","properties":{"name":"南昌县"},"geometry":{"type":"MultiPolygon","coordinates":[[[[116.266173125,28.9309230781251],[116.26037234375,28.9050368476563],[116.287764921875,28.9111794257813],[116.297345,28.8738430000001],[116.2227746875,28.8673439765625],[116.2429309375,28.8486647773438],[116.241358671875,28.8089040351563],[116.272535429688,28.7990334296876],[116.309263945313,28.7861598945313],[116.317345,28.743843],[116.290499296875,28.7286672187501],[116.293018828125,28.7084377265625],[116.2613684375,28.6688674140625],[116.291793242188,28.62722190625],[116.262579375,28.6181911445312],[116.244644804688,28.6204225898438],[116.202896757813,28.5682888007813],[116.153746367188,28.5384352851563],[116.1414075,28.4814040351563],[116.120831328125,28.455708234375],[116.04423953125,28.4775807929688],[116.021676054688,28.4392018867188],[116.024830351563,28.413843],[116.020084257813,28.3756716132812],[116.052896757813,28.3493971992188],[116.078267851563,28.3177150703125],[116.09431765625,28.3197096992187],[116.091705351563,28.2986818671876],[116.097345,28.2738430000001],[116.081519804688,28.2780178046875],[116.0532825,28.2959450507813],[116.002345,28.2858791328125],[115.982345,28.2898317695313],[115.950299101563,28.2834987617188],[115.953453398438,28.2994631171876],[115.922789335938,28.3214406562501],[115.912345,28.3068679023438],[115.902345,28.3208180976563],[115.887701445313,28.3003884101563],[115.867203398438,28.2896681953125],[115.848839140625,28.3812697578126],[115.817345,28.403843],[115.82142703125,28.4397585273437],[115.841241484375,28.4701857734376],[115.79812625,28.5218898750001],[115.81326296875,28.5579274726563],[115.82142703125,28.6197585273438],[115.827345,28.623843],[115.827345,28.6138430000001],[115.877345,28.6138430000001],[115.8886340625,28.6051296210938],[115.901846953125,28.5880104804688],[115.937345,28.593843],[116.011451445313,28.5879079414063],[116.043297148438,28.6098195625],[116.041729765625,28.6494142890625],[116.022178984375,28.648637921875],[115.990636015625,28.6653322578126],[116.012550078125,28.71868675],[116.012125273438,28.7294289375],[115.986798125,28.7284255195313],[115.932535429688,28.74085471875],[115.981475859375,28.7862038398438],[115.957345,28.793843],[115.965225859375,28.8245534492188],[116.002066679688,28.8400270820313],[116.0226184375,28.8354201484375],[116.035045195313,28.8838430000001],[116.062345,28.8899636054688],[116.087345,28.884360578125],[116.122345,28.8922048164063],[116.148375273438,28.8863698554687],[116.183902617188,28.937827375],[116.22326296875,28.9479274726563],[116.253975859375,28.9679274726563],[116.266173125,28.9309230781251]]]]}},{"type":"Feature","properties":{"name":"青山湖区"},"geometry":{"type":"MultiPolygon","coordinates":[[[[115.891353789063,28.6656838203126],[115.897345,28.6538430000001],[115.877345,28.6138430000001],[115.827345,28.6138430000001],[115.827345,28.623843],[115.857345,28.663843],[115.872330351563,28.6563942695313],[115.891353789063,28.6656838203126]]],[[[115.87646609375,28.81368675],[115.934498320313,28.769184796875],[115.957345,28.793843],[115.981475859375,28.7862038398438],[115.932535429688,28.74085471875],[115.986798125,28.7284255195313],[116.012125273438,28.7294289375],[116.012550078125,28.71868675],[115.990636015625,28.6653322578126],[116.022178984375,28.648637921875],[116.041729765625,28.6494142890625],[116.043297148438,28.6098195625],[116.011451445313,28.5879079414063],[115.937345,28.593843],[115.948170195313,28.6379201484375],[115.92142703125,28.6479274726563],[115.917345,28.6538430000001],[115.947345,28.6538430000001],[115.947345,28.673843],[115.94310671875,28.7110964179688],[115.923975859375,28.7279274726563],[115.87638796875,28.696938703125],[115.867345,28.6838430000001],[115.840704375,28.687202375],[115.827296171875,28.7137038398438],[115.811954375,28.7062111640626],[115.791280546875,28.7226320625],[115.787345,28.753843],[115.80423953125,28.7578224921875],[115.813902617188,28.788843],[115.81047,28.799868390625],[115.827345,28.8038430000001],[115.842193632813,28.798637921875],[115.852345,28.7990407539063],[115.86252078125,28.798637921875],[115.87646609375,28.81368675]]]]}},{"type":"Feature","properties":{"name":"青云谱区"},"geometry":{"type":"MultiPolygon","coordinates":[[[[115.937345,28.593843],[115.901846953125,28.5880104804688],[115.8886340625,28.6051296210938],[115.877345,28.6138430000001],[115.897345,28.6538430000001],[115.917345,28.6538430000001],[115.92142703125,28.6479274726563],[115.948170195313,28.6379201484375],[115.937345,28.593843]]]]}},{"type":"Feature","properties":{"name":"湾里区"},"geometry":{"type":"MultiPolygon","coordinates":[[[[115.647345,28.6938430000001],[115.659537382813,28.6904201484375],[115.650767851563,28.6816506171875],[115.647345,28.6938430000001]]],[[[115.647345,28.6938430000001],[115.627345,28.6938430000001],[115.643980742188,28.7285915351563],[115.6357825,28.7549123359376],[115.651158476563,28.8000295234375],[115.657345,28.8038430000001],[115.660767851563,28.7916506171875],[115.669537382813,28.8004201484375],[115.657345,28.8038430000001],[115.661519804688,28.8096681953126],[115.693170195313,28.8280178046876],[115.707345,28.8477956367188],[115.721519804688,28.8280178046876],[115.740968046875,28.8196681953126],[115.754000273438,28.8690724921876],[115.740367460938,28.8788430000001],[115.753170195313,28.8880178046875],[115.757345,28.893843],[115.770704375,28.9004836250001],[115.807345,28.903843],[115.821373320313,28.8941579414063],[115.80326296875,28.8679274726563],[115.787554960938,28.8570827460937],[115.776954375,28.8097878242188],[115.823160429688,28.8201467109375],[115.827345,28.8038430000001],[115.81047,28.799868390625],[115.813902617188,28.788843],[115.80423953125,28.7578224921875],[115.787345,28.753843],[115.784801054688,28.7612990546875],[115.751197539063,28.7663869453125],[115.744801054688,28.741509015625],[115.778443632813,28.7076296210938],[115.759888945313,28.7012990546875],[115.754801054688,28.6763869453126],[115.735011015625,28.6712990546876],[115.704801054688,28.7012990546875],[115.65162234375,28.7063869453126],[115.647345,28.6938430000001]]]]}},{"type":"Feature","properties":{"name":"西湖区"},"geometry":{"type":"MultiPolygon","coordinates":[[[[115.947345,28.673843],[115.947345,28.6538430000001],[115.917345,28.6538430000001],[115.897345,28.6538430000001],[115.891353789063,28.6656838203126],[115.872330351563,28.6563942695313],[115.857345,28.663843],[115.867345,28.6838430000001],[115.880704375,28.6772023750001],[115.947345,28.673843]]]]}},{"type":"Feature","properties":{"name":"新建县"},"geometry":{"type":"MultiPolygon","coordinates":[[[[115.647345,28.6938430000001],[115.650767851563,28.6816506171875],[115.659537382813,28.6904201484375],[115.65162234375,28.7063869453126],[115.704801054688,28.7012990546875],[115.735011015625,28.6712990546876],[115.754801054688,28.6763869453126],[115.759888945313,28.7012990546875],[115.778443632813,28.7076296210938],[115.744801054688,28.741509015625],[115.751197539063,28.7663869453125],[115.784801054688,28.7612990546875],[115.787345,28.753843],[115.791280546875,28.7226320625],[115.811954375,28.7062111640626],[115.827296171875,28.7137038398438],[115.840704375,28.687202375],[115.867345,28.6838430000001],[115.857345,28.663843],[115.827345,28.623843],[115.82142703125,28.6197585273438],[115.81326296875,28.5579274726563],[115.79812625,28.5218898750001],[115.841241484375,28.4701857734376],[115.82142703125,28.4397585273437],[115.817345,28.403843],[115.80170046875,28.39948753125],[115.775928984375,28.3660964179688],[115.75205203125,28.36962425],[115.72220828125,28.3578932929688],[115.695289335938,28.3741335273438],[115.67490359375,28.3477248359376],[115.661954375,28.3496388984375],[115.642735625,28.3380471015625],[115.6161340625,28.341977765625],[115.649386015625,28.3868288398438],[115.62170046875,28.40819846875],[115.61298953125,28.41948753125],[115.598424101563,28.4281984687501],[115.5786340625,28.4025563789063],[115.527345,28.393843],[115.5309778125,28.4102126289063],[115.550767851563,28.4214968085938],[115.540460234375,28.448843],[115.54611453125,28.4638430000001],[115.538795195313,28.4832643867188],[115.564561796875,28.4979592109375],[115.560460234375,28.508843],[115.5698840625,28.5338430000001],[115.557022734375,28.5679592109375],[115.5737121875,28.5774733710938],[115.5809778125,28.5948830390625],[115.557345,28.583843],[115.56170046875,28.60948753125],[115.590894804688,28.6488649726563],[115.610738554688,28.6641823554688],[115.627345,28.6938430000001],[115.647345,28.6938430000001]],[[115.665152617188,28.3672658515626],[115.677345,28.363843],[115.673922148438,28.3760353828125],[115.665152617188,28.3672658515626]]],[[[115.817345,28.973843],[115.805152617188,28.9772658515626],[115.813922148438,28.9860353828125],[115.817345,28.973843]]],[[[115.817345,28.973843],[115.860582304688,28.9796266914063],[115.892061796875,29.0291237617187],[115.911929960938,29.0468752265625],[115.912940703125,29.063843],[115.911485625,29.0882570625],[115.955806914063,29.1001271796876],[115.982569609375,29.0985305000001],[116.00244265625,29.1093288398438],[116.01603640625,29.0941139960938],[116.062120390625,29.1191555000001],[116.0774621875,29.1182399726562],[116.167345,29.123843],[116.138990507813,29.0851467109376],[116.170250273438,29.0488625312501],[116.220220976563,29.0375099921876],[116.232960234375,28.9951930976563],[116.271422148438,29.0123561835938],[116.272764921875,29.0290456367188],[116.25271609375,29.1022927070313],[116.284205351563,29.1136110664063],[116.36197390625,29.0584719062501],[116.397345,29.053843],[116.397345,29.043843],[116.407345,29.043843],[116.3988684375,29.0093410468751],[116.403975859375,28.9865651679688],[116.39326296875,28.9579274726563],[116.36455203125,28.9381056953126],[116.348082304688,28.8940920234375],[116.32326296875,28.8779274726563],[116.297345,28.8738430000001],[116.287764921875,28.9111794257813],[116.26037234375,28.9050368476563],[116.266173125,28.9309230781251],[116.253975859375,28.9679274726563],[116.22326296875,28.9479274726563],[116.183902617188,28.937827375],[116.148375273438,28.8863698554687],[116.122345,28.8922048164063],[116.087345,28.884360578125],[116.062345,28.8899636054688],[116.035045195313,28.8838430000001],[116.0226184375,28.8354201484375],[116.002066679688,28.8400270820313],[115.965225859375,28.8245534492188],[115.957345,28.793843],[115.934498320313,28.769184796875],[115.87646609375,28.81368675],[115.86252078125,28.798637921875],[115.852345,28.7990407539063],[115.842193632813,28.798637921875],[115.827345,28.8038430000001],[115.823160429688,28.8201467109375],[115.776954375,28.8097878242188],[115.787554960938,28.8570827460937],[115.80326296875,28.8679274726563],[115.821373320313,28.8941579414063],[115.807345,28.903843],[115.81298953125,28.93819846875],[115.817345,28.973843]]]]}}]};

            var getMapData = function(){
                $.ajax({
                    type: 'POST',
                    url: "{% url 'datacockpit:get_mapdata' %}",
                    data: {"type": "1"},
                    datatype: "JSON",
                    async: false,
                    success: function (data) {
                        mapData = JSON.parse(data);
                    }
                });
            };
            getMapData();

            echarts.registerMap(name, jx);

            myChart.setOption(option = {
                //地图配置
                geo: {
                    type: 'map',
                    zoom: 1.2,
                    roam: true,
                    label: {
                        normal: {
                            show: false,
                            color:'#fff'
                        },
                        emphasis: {
                            textStyle: {
                                color: '#fff'
                            }
                        }
                    },
                    itemStyle: {
                        normal: {
                            borderColor: '#F4B461',
                            areaColor: '#334553',
                        },
                        emphasis: {
                            areaColor: '#8B5360',
                            borderWidth: 0
                        }
                    },

                },
                series: [{
                    tooltip: {

                    },
                    type: 'effectScatter',
                    coordinateSystem: 'geo',
                    // animation: true,
                    rippleEffect: {
                        brushType: 'stroke'
                    },
                    symbolSize: function (val,params) {
                        return 20;
                    },
                    data: mapData.map(function (itemOpt) {
                        return {
                            name: itemOpt.name,
                            value: [
                                itemOpt.longitude,
                                itemOpt.latitude,
                                itemOpt.value
                            ],
                            label: {
                                emphasis: {
                                    position: 'left',
                                    show: true,
                                    formatter: itemOpt.name
                                }
                            },
                            itemStyle: {
                                normal: {
                                    color: itemOpt.color
                                }
                            }
                        };
                    })

                }]
            });

            var drawRealavgData = function(){
                $.ajax({
                    type: 'POST',
                    url: "{% url 'devicecockpit:get_envrealtimedata' %}",
                    data: {"prjid": ""},
                    datatype: "JSON",
                    success: function (data) {
                        result = JSON.parse(data);
                        $("#prjName").html("<span style='color: wheat; font-size: 15px'><p><i class='fa fa-street-view' aria-hidden='true'></i> 实时平均数据</p></span>");

                        $("#city_pm25").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[0].value +"</span>");
                        $("#city_pm10").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[1].value +"</span>");
                        $("#city_noise").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[6].value +"</span>");

                        $("#city_temp").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[4].value +"</span>");
                        $("#city_shidu").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[5].value +"</span>");
                        if (result[3].value <= 0.2){
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;无风</span>");
                        } else if (result[3].value > 0.2 && result[3].value <= 1.5) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;一级</span>");
                        } else if (result[3].value > 1.5 && result[3].value <= 3.3) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;二级</span>");
                        } else if (result[3].value > 3.3 && result[3].value <= 5.4) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;三级</span>");
                        } else if (result[3].value > 5.4 && result[3].value <= 7.9) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;四级</span>");
                        } else if (result[3].value > 7.9 && result[3].value <= 10.7) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;五级</span>");
                        } else if (result[3].value > 10.7 && result[3].value <= 13.8) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;六级</span>");
                        } else if (result[3].value > 13.8 && result[3].value <= 17.1) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;七级</span>");
                        } else if (result[3].value > 17.1 && result[3].value <= 20.7) {
                            $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;八级</span>");
                        }
                    }
                });
            };

            drawRealavgData();

            myChart.on('click', function (params) {
                if (params.componentType == "series") {
                    $.ajax({
                        type: 'POST',
                        url: "{% url 'devicecockpit:get_envrealtimedata' %}",
                        data: {"prjid": params.value[2]},
                        datatype: "JSON",
                        success: function (data) {

                            ins.slide("sub");

                            result = JSON.parse(data);
                            $("#prjName").html("<span style='color: wheat; font-size: 15px'><p><i class='fa fa-street-view' aria-hidden='true'></i> 实时数据 ["+ params.name +"]</p></span>");

                            $("#city_pm25").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[0].value +"</span>");
                            $("#city_pm10").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[1].value +"</span>");
                            $("#city_noise").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[6].value.toFixed(1) +"</span>");

                            $("#city_temp").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[4].value.toFixed(1) +"</span>");
                            $("#city_shidu").html("<span style='font-size: 34px; color: #A7FFFD'>&nbsp;"+ result[5].value.toFixed(1) +"</span>");
                            if (result[3].value <= 0.2){
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;无风</span>");
                            } else if (result[3].value > 0.2 && result[3].value <= 1.5) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;一级</span>");
                            } else if (result[3].value > 1.5 && result[3].value <= 3.3) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;二级</span>");
                            } else if (result[3].value > 3.3 && result[3].value <= 5.4) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;三级</span>");
                            } else if (result[3].value > 5.4 && result[3].value <= 7.9) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;四级</span>");
                            } else if (result[3].value > 7.9 && result[3].value <= 10.7) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;五级</span>");
                            } else if (result[3].value > 10.7 && result[3].value <= 13.8) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;六级</span>");
                            } else if (result[3].value > 13.8 && result[3].value <= 17.1) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;七级</span>");
                            } else if (result[3].value > 17.1 && result[3].value <= 20.7) {
                                $("#city_fengsu").html("<span style='font-size: 32px; color: #A7FFFD'>&nbsp;八级</span>");
                            }

                            //envrealtime_cockpit(data)
                        }
                    });

                    $.ajax({
                        type: 'POST',
                        url: "{% url 'devicecockpit:get_envhisdata' %}",
                        data: {"prjid": params.value[2]},
                        datatype: "JSON",
                        success: function (data) {
                            var dom = document.getElementById("prj_hisdata");
                            var myChart = echarts.init(dom);

                            var days = data.FDay;
                            var pm25 = data.FPM25;
                            var pm10 = data.FPM10;

                            option = {
                                tooltip: {
                                    trigger: 'axis',
                                    axisPointer: {
                                        animation: false
                                    }
                                },
                                textStyle:{
                                    color:'white',
                                    fontStyle: "bold"
                                },
                                legend: {
                                    x: 'left',
                                    y: 'top',
                                    color: ["#66cc00", "#d94d02"],
                                    data:[{name: "PM2.5", textStyle:{color: "#66cc00"}}, {name: "PM10", textStyle:{color: "#d94d02"}}],
                                },
                                toolbox: {
                                    feature: {
                                        dataZoom: {
                                            yAxisIndex: 'none'
                                        },
                                        restore: {},
                                        saveAsImage: {}
                                    }
                                },
                                axisPointer: {
                                    link: {xAxisIndex: 'all'}
                                },
                                dataZoom: [
                                    {
                                        show: true,
                                        realtime: true,
                                        start: 30,
                                        end: 70,
                                        xAxisIndex: [0, 1]
                                    },
                                    {
                                        type: 'inside',
                                        realtime: true,
                                        start: 30,
                                        end: 70,
                                        xAxisIndex: [0, 1]
                                    }
                                ],
                                grid: [{
                                    left: 50,
                                    right: 50,
                                    height: '35%'
                                }, {
                                    left: 50,
                                    right: 50,
                                    top: '55%',
                                    height: '35%'
                                }],
                                xAxis : [
                                    {
                                        type : 'category',
                                        boundaryGap : false,
                                        splitLine: {
                                            show: false
                                        },
                                        axisLine: {onZero: true},
                                        data: days
                                    },
                                    {
                                        gridIndex: 1,
                                        type : 'category',
                                        boundaryGap : false,
                                        splitLine: {
                                            show: false
                                        },
                                        axisLine: {onZero: true},
                                        data: days,
                                        position: 'top'
                                    }
                                ],
                                yAxis : [
                                    {
                                        name : 'PM2.5',
                                        type : 'value',
                                        minInterval: 1
                                        //max : 500
                                    },
                                    {
                                        gridIndex: 1,
                                        name : 'PM10',
                                        type : 'value',
                                        minInterval: 1,
                                        inverse: true
                                    }
                                ],
                                series : [
                                    {
                                        name:'PM2.5',
                                        type:'line',
                                        itemStyle : {
                                            normal : {
                                                color:'#e01f54',   // 设置最高气温线的颜色
                                            }
                                        },
                                        symbolSize: 10,
                                        hoverAnimation: false,
                                        data: pm25
                                    },
                                    {
                                        name:'PM10',
                                        type:'line',
                                        itemStyle : {
                                            normal : {
                                                color:'#82b6e9',   // 设置最高气温线的颜色
                                            }
                                        },
                                        xAxisIndex: 1,
                                        yAxisIndex: 1,
                                        symbolSize: 10,
                                        hoverAnimation: false,
                                        data: pm10
                                    }
                                ]
                            };

                            myChart.setOption(option, true);
                        }
                    });

                }
            });

            var envHisData = function (data) {
                var dom = document.getElementById("prj_hisdata");
                var myChart = echarts.init(dom);

                var days = data.FDay;
                var pm25 = data.FPM25;
                var pm10 = data.FPM10;

                option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            animation: false
                        }
                    },
                    textStyle:{
                        color:'white',
                        fontStyle: "bold"
                    },
                    legend: {
                        x: 'left',
                        y: 'top',
                        color: ["#66cc00", "#d94d02"],
                        data:[{name: "PM2.5", textStyle:{color: "#66cc00"}}, {name: "PM10", textStyle:{color: "#d94d02"}}],
                    },
                    toolbox: {
                        feature: {
                            dataZoom: {
                                yAxisIndex: 'none'
                            },
                            restore: {},
                            saveAsImage: {}
                        }
                    },
                    axisPointer: {
                        link: {xAxisIndex: 'all'}
                    },
                    dataZoom: [
                        {
                            show: true,
                            realtime: true,
                            start: 30,
                            end: 70,
                            xAxisIndex: [0, 1]
                        },
                        {
                            type: 'inside',
                            realtime: true,
                            start: 30,
                            end: 70,
                            xAxisIndex: [0, 1]
                        }
                    ],
                    grid: [{
                        left: 50,
                        right: 50,
                        height: '35%'
                    }, {
                        left: 50,
                        right: 50,
                        top: '55%',
                        height: '35%'
                    }],
                    xAxis : [
                        {
                            type : 'category',
                            boundaryGap : false,
                            splitLine: {
                                show: false
                            },
                            axisLine: {onZero: true},
                            data: days
                        },
                        {
                            gridIndex: 1,
                            type : 'category',
                            boundaryGap : false,
                            splitLine: {
                                show: false
                            },
                            axisLine: {onZero: true},
                            data: days,
                            position: 'top'
                        }
                    ],
                    yAxis : [
                        {
                            name : 'PM2.5',
                            type : 'value',
                            minInterval: 1
                            //max : 500
                        },
                        {
                            gridIndex: 1,
                            name : 'PM10',
                            type : 'value',
                            minInterval: 1,
                            inverse: true
                        }
                    ],
                    series : [
                        {
                            name:'PM2.5',
                            type:'line',
                            itemStyle : {
                                normal : {
                                    color:'#e01f54',   // 设置最高气温线的颜色
                                }
                            },
                            symbolSize: 10,
                            hoverAnimation: false,
                            data: pm25
                        },
                        {
                            name:'PM10',
                            type:'line',
                            itemStyle : {
                                normal : {
                                    color:'#82b6e9',   // 设置最高气温线的颜色
                                }
                            },
                            xAxisIndex: 1,
                            yAxisIndex: 1,
                            symbolSize: 10,
                            hoverAnimation: false,
                            data: pm10
                        }
                    ]
                };

                myChart.setOption(option, true);
            };

            var drawEnvHisAvg = function () {
                $.ajax({
                    type: 'POST',
                    url: "{% url 'devicecockpit:get_envhisdata' %}",
                    data: {"prjid": ""},
                    datatype: "JSON",
                    success: function (data) {
                        envHisData(data);
                    }
                });
            };

            drawEnvHisAvg();


            var areaData = function (data) {
                var dom = document.getElementById("area_analyse");
                var myChart = echarts.init(dom, 'dark');

                var areaData = data.areadata;
                var prjData = data.prjdata;
                var pm25Data = data.pm25data;
                var pm10Data = data.pm10data;
                var noiseData = data.noisedata;
                var tempData = data.tempdata;
                var humData = data.humdata;


                option = {
                    title: {
                        text: '区域环境检测数据分析',
                        subtext: '',
                        show: false
                    },

                    grid: {
                        top: 100
                    },
                    angleAxis: {
                        //type: "value",
                        //minInterval: 1
                        type: 'category',
                        data: areaData
                    },
                    tooltip: {
                    },
                    radiusAxis: {
                        axisLine:{                      //坐标 轴线
                            show: true,                  //是否显示坐标轴轴线
                            onZero:true,                //X 轴或者 Y 轴的轴线是否在另一个轴的 0 刻度上，只有在另一个轴为数值轴且包含 0 刻度时有效
                        },
                        axisTick : {                     //坐标轴刻度相关设置
                            show: false,
                        },
                        axisLabel:{
                            show: false
                        }
                        //type: 'category',
                        //data: gname,
                        //z: 10
                    },
                    polar: {
                    },
                    series: [{
                        type: 'bar',
                        data: pm25Data,
                        coordinateSystem: 'polar',
                        name: 'PM2.5',
                        stack: 'a'
                    }, {
                        type: 'bar',
                        data: pm10Data,
                        coordinateSystem: 'polar',
                        name: 'PM10',
                        stack: 'a',
                    }, {
                        type: 'bar',
                        data: noiseData,
                        coordinateSystem: 'polar',
                        name: '噪声',
                        stack: 'a',
                    }, {
                        type: 'bar',
                        data: tempData,
                        coordinateSystem: 'polar',
                        name: '温度',
                        stack: 'a',
                    }, {
                        type: 'bar',
                        data: humData,
                        coordinateSystem: 'polar',
                        name: '湿度',
                        stack: 'a',
                    },
                    ],

                    legend: {
                        show: true,
                        data: ['PM2.5', 'PM10', '噪声', '温度', '湿度']
                    }
                };

                myChart.setOption(option, true);
            };

            var drawAreaAnalyse = function() {
                $.ajax({
                    type: 'POST',
                    url: "{% url 'devicecockpit:get_area_analyse' %}",
                    data: {},
                    datatype: "JSON",
                    success: function (data) {
                        areaData(data);
                    }
                });
            };

            drawAreaAnalyse();


            window.onresize = function() {

                myCharta.resize();
                //myCharta1.resize();
            };
        });
	</script>

</html>